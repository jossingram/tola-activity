{% extends "base.html" %}
{% block bread_crumb %}
<div>
<ol class="breadcrumb">
  <li><a href="/activitydb/dashboard/0/">Program Dashboards</a></li>
  <li class="active">Project Dashboard</li>
</ol>
</div>
{% endblock %}
{% block page_title %}Project Dashboard{% endblock %}

{% block content %}
<div>
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
    Programs
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    {% for program in getPrograms %}
        <li role="presentation"><a role="menuitem" tabindex="-1" href="/activitydb/dashboard/{{ program.id }}">{{ program.gaitid}} - {{ program.name }}</a></li>
    {% endfor %}
  </ul>
  <a href="/activitydb/projectproposal_add" class="btn btn-large btn-success">New Project Proposal</a>
  <a href="/activitydb/projectproposal_import" class="btn btn-large btn-info" data-toggle="modal" data-target="#importModal">Import Project Proposal</a>
</div>
</div>
<br/>
<ul class="list-group">
<h3>{{getProgram.gaitid }} - {{ getProgram.name }}</h3>
{% for agreement in getDashboard %}
    <div class="jumbotron">
        <ul class="list-group">
            <li class="list-group-item list-group-item-info">
                <h4>Project Agreement</h4>
            </li>

            <li class="list-group-item"><b>Name: </b>{{ agreement.project_agreement.project_name }}<br/>
                <b>Activity Code: </b>{{ agreement.project_agreement.activity_code }}<br/>
                <b>Created:</b> <span class="date-badge">{{ agreement.project_agreement.create_date|date }}</span> <b>Edited:</b> <span class="date-badge">{{ agreement.project_agreement.edit_date|date }}</span>
            </li>
            <li class="list-group-item">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-sm btn-warning" onclick="location.href='/activitydb/projectagreement_update/{{ agreement.project_agreement.id }}'">Update Agreement</button>
                    {% if agreement.project_agreement.approval == "approved" %}
                        <button data-toggle="tooltip" data-placement="top" title="Agreement has been approved and can no longer be deleted." type="button" class="btn btn-sm btn-frozen">Delete Agreement</button>
                        {% if not agreement.project_completion %}
                            <button type="button" class="btn btn-sm btn-info" onclick="location.href='/activitydb/projectcomplete_add/{{ agreement.project_agreement.id }}'">Complete Project</button>
                        {% else %}
                            <button data-toggle="tooltip" data-placement="top" title="A completion form has already been created for the project" type="button" class="btn btn-sm btn-frozen">Complete Project</button>
                        {% endif %}
                    {% else %}
                        <button type="button" class="btn btn-sm btn-danger" onclick="location.href='/activitydb/projectagreement_delete/{{ agreement.project_agreement.id }}'">Delete Agreement</button>
                        <button data-toggle="tooltip" data-placement="top" title="Once Approved you will be able to click here and complete the project" type="button" class="btn btn-sm btn-frozen">Complete Project</button>
                    {% endif %}
                </div>
            </li>
            <li class="list-group-item">
                {% if agreement.project_agreement.approval == "approved" %}
                    <button class="btn btn-success" type="button">
                      Approved
                    </button>
                {% else %}
                    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/projectagreement_update/{{ agreement.project_agreement.id }}'">
                    {% if agreement.project_agreement.approval %}
                        {{ agreement.project_agreement.approval|title }}
                    {% else %}
                        Open
                    {% endif %}
                    </button>
                {% endif %}
             </li>
        </ul>

    {% if agreement.project_completion %}
        <ul class="list-group">
            <li class="list-group-item list-group-item-info">
                <h4>Project Completion</h4>
            </li>
            <li class="list-group-item"><b>Name: </b>{{ agreement.project_completion.project_name }}<br/>
                <b>Activity Code: </b>{{ agreement.project_completion.activity_code }}<br/>
                <b>Created:</b> <span class="date-badge">{{ agreement.project_completion.create_date|date }}</span> <b>Edited:</b> <span class="date-badge">{{ agreement.project_completion.edit_date|date }}</span>
            </li>
            <li class="list-group-item">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-sm btn-warning" onclick="location.href='/activitydb/projectcomplete_update/{{ agreement.project_completion.id }}'">Update Completion</button>
                    <button type="button" class="btn btn-sm btn-danger" onclick="location.href='/activitydb/projectcomplete_delete/{{ agreement.project_completion.id }}'">Delete Completion</button>
                </div>
            </li>
            <li class="list-group-item">
                {% if agreement.project_completion.approval == "approved" %}
                    <button class="btn btn-success" type="button">
                      Approved
                    </button>
                {% else %}
                    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/projectcomplete_update/{{ agreement.project_completion.id }}'">
                      {% if agreement.project_completion.approval %}
                        {{ agreement.project_completion.approval|title }}
                      {% else %}
                        Open
                      {% endif %}
                    </button>
                {% endif %}
             </li>
        </ul>
    {% endif %}
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/documentation_list/{{ agreement.project_agreement.id }}'">
        Documentation <span class="badge">{{ getDocumentCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/community_list/0/{{ agreement.project_agreement.id }}'">
        Communities <span class="badge">{{ getCommunityCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/training_list/{{ agreement.project_agreement.id }}'">
        Training <span class="badge">{{ getTrainingCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/monitor_list/{{ agreement.project_agreement.id }}'">
        Project Planning <span class="badge">{{ getMonitoringCount }}</span>
    </button>
    </div>
{% empty %}
    <li class="list-group-item">No Projects yet.</li>
    </div>
{% endfor %}
</ul>

<!-- Modal -->
<div class="modal fade" id="importModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
        </div> <!-- /.modal-content -->
    </div> <!-- /.modal-dialog -->
</div> <!-- /.modal -->
{% endblock content %}