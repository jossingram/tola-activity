{% extends "base.html" %}
{% block bread_crumb %}
<div>
<ol class="breadcrumb">
  <li><a href="/activitydb/dashboard/0/">Program Dashboards</a></li>
  <li><a href="/activitydb/projectproposal_list/{{ getProgram.id }}">Proposal</a></li>
  <li class="active">Project Dashboard</li>
</ol>
</div>
{% endblock %}
{% block page_title %}Project Dashboard{% endblock %}

{% block content %}
<div>
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
    Programs
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    {% for program in getPrograms %}
        <li role="presentation"><a role="menuitem" tabindex="-1" href="/activitydb/dashboard/{{ program.id }}">{{ program.gaitid}} - {{ program.name }}</a></li>
    {% endfor %}
  </ul>
  <a href="/activitydb/projectproposal_add" class="btn btn-large btn-success">New Project Proposal</a>
  <a href="/activitydb/projectproposal_import" class="btn btn-large btn-info">Import Project Proposal</a>
</div>
</div>
<br/>
<ul class="list-group">
<h3>{{getProgram.gaitid }} - {{ getProgram.name }}</h3>
{% for proposal in getDashboard %}
    <div class="jumbotron">
    <ul class="list-group">
        <li class="list-group-item list-group-item-info">
            <h4>Project Proposal</h4>
        </li>

        <li class="list-group-item"><b>Name: </b>{{ proposal.project_proposal.project_name }}<br/>
            <b>Activity Code: </b>{{ proposal.project_proposal.activity_code }}<br/>
            <b>Created:</b> <span class="date-badge">{{ proposal.project_proposal.create_date|date }}</span> <b>Edited:</b> <span class="date-badge">{{ proposal.project_proposal.edit_date|date }}</span>
        </li>
        <li class="list-group-item">
            <div class="btn-group" role="group" aria-label="...">
                <button data-toggle="tooltip" data-placement="top" onclick="location.href='/activitydb/projectproposal_update/{{ proposal.project_proposal.id }}'" type="button" class="btn btn-sm btn-warning">Update Proposal</button>
                {% if proposal.project_proposal.approval == "approved" %}
                    <button data-toggle="tooltip" data-placement="top" title="Proposal has been approved and can no longer be deleted." type="button" class="btn btn-sm btn-frozen">Delete Proposal</button>
                    {% if not proposal.project_agreement %}
                        <button type="button" class="btn btn-sm btn-info" onclick="location.href='/activitydb/projectagreement_add/{{ proposal.project_proposal.id }}'">Create an Agreement</button>
                    {% else %}
                        <button data-toggle="tooltip" data-placement="top" title="An agreement has already been created for this project" type="button" class="btn btn-sm btn-frozen">Create an Agreement</button>
                    {% endif %}
                {% else %}
                    <button type="button" class="btn btn-sm btn-danger" onclick="location.href='/activitydb/projectproposal_delete/{{ proposal.project_proposal.id }}'">Delete Proposal</button>
                    <button data-toggle="tooltip" data-placement="top" title="Once Approved you will be able to click here and create a project agreement" type="button" class="btn btn-sm btn-frozen">Create an Agreement</button>
                {% endif %}
            </div>
        </li>
        <li class="list-group-item">
            {% if proposal.project_proposal.approval == "approved" %}
                <button class="btn btn-success" type="button">
                  Approved
                </button>
            {% else %}
                <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/projectproposal_update/{{ proposal.project_proposal.id }}'">
                {% if  proposal.project_proposal.approval %}
                    {{ proposal.project_proposal.approval|title }}
                {% else %}
                   Open
                {% endif %}
                </button>
            {% endif %}
         </li>

    </ul>
    {% if proposal.project_agreement %}
        <ul class="list-group">
            <li class="list-group-item list-group-item-info">
                <h4>Project Agreement</h4>
            </li>

            <li class="list-group-item"><b>Name: </b>{{ proposal.project_agreement.project_name }}<br/>
                <b>Activity Code: </b>{{ proposal.project_agreement.activity_code }}<br/>
                <b>Created:</b> <span class="date-badge">{{ proposal.project_agreement.create_date|date }}</span> <b>Edited:</b> <span class="date-badge">{{ proposal.project_agreement.edit_date|date }}</span>
            </li>
            <li class="list-group-item">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-sm btn-warning" onclick="location.href='/activitydb/projectagreement_update/{{ proposal.project_agreement.id }}'">Update Agreement</button>
                    {% if proposal.project_agreement.approval == "approved" %}
                        <button data-toggle="tooltip" data-placement="top" title="Agreement has been approved and can no longer be deleted." type="button" class="btn btn-sm btn-frozen">Delete Agreement</button>
                        {% if not proposal.project_completion %}
                            <button type="button" class="btn btn-sm btn-info" onclick="location.href='/activitydb/projectcomplete_add/{{ proposal.project_agreement.id }}'">Complete Project</button>
                        {% else %}
                            <button data-toggle="tooltip" data-placement="top" title="A completion form has already been created for the project" type="button" class="btn btn-sm btn-frozen">Complete Project</button>
                        {% endif %}
                    {% else %}
                        <button type="button" class="btn btn-sm btn-danger" onclick="location.href='/activitydb/projectagreement_delete/{{ proposal.project_agreement.id }}'">Delete Agreement</button>
                        <button data-toggle="tooltip" data-placement="top" title="Once Approved you will be able to click here and complete the project" type="button" class="btn btn-sm btn-frozen">Complete Project</button>
                    {% endif %}
                </div>
            </li>
            <li class="list-group-item">
                {% if proposal.project_agreement.approval == "approved" %}
                    <button class="btn btn-success" type="button">
                      Approved
                    </button>
                {% else %}
                    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/projectagreement_update/{{ proposal.project_agreement.id }}'">
                    {% if proposal.project_agreement.approval %}
                        {{ proposal.project_agreement.approval|title }}
                    {% else %}
                        Open
                    {% endif %}
                    </button>
                {% endif %}
             </li>
        </ul>
    {% endif %}

    {% if proposal.project_completion %}
        <h4>Project Completion</h4>
        <ul class="list-group">
            <li class="list-group-item list-group-item-info">
                <h4>Project Completion</h4>
            </li>
            <li class="list-group-item"><b>Name: </b>{{ proposal.project_agreement.project_name }}<br/>
                <b>Activity Code: </b>{{ proposal.project_agreement.activity_code }}<br/>
                <b>Created:</b> <span class="date-badge">{{ proposal.project_agreement.create_date|date }}</span> <b>Edited:</b> <span class="date-badge">{{ proposal.project_agreement.edit_date|date }}</span>
            </li>
            <li class="list-group-item">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-sm btn-warning" onclick="location.href='/activitydb/projectcomplete_update/{{ proposal.project_completion.id }}'">Update Completion</button>
                    <button type="button" class="btn btn-sm btn-danger" onclick="location.href='/activitydb/projectacomplete_delete/{{ proposal.project_completion.id }}'">Delete Completion</button>
                </div>
            </li>
            <li class="list-group-item">
                {% if proposal.project_complete.approval == "approved" %}
                    <button class="btn btn-success" type="button">
                      Approved
                    </button>
                {% else %}
                    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/projectcomplete_update/{{ proposal.project_completion.id }}'">
                      {% if proposal.project_complete.approval %}
                        {{ proposal.project_complete.approval|title }}
                      {% else %}
                        Open
                      {% endif %}
                    </button>
                {% endif %}
             </li>
        </ul>
    {% endif %}
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/documentation_list/{{ proposal.project_proposal.id }}'">
        Documentation <span class="badge">{{ getDocumentCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/community_list/{{ proposal.project_proposal.id }}'">
        Communities <span class="badge">{{ getCommunityCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/training_list/{{ proposal.project_proposal.id }}'">
        Training <span class="badge">{{ getTrainingCount }}</span>
    </button>
    <button class="btn btn-primary" type="button" onclick="location.href='/activitydb/monitor_list/{{ proposal.project_proposal.id }}'">
        Project Planning <span class="badge">{{ getMonitoringCount }}</span>
    </button>
    </div>
{% empty %}
    <li class="list-group-item">No proposals yet.</li>
    </div>
{% endfor %}
</ul>
{% endblock content %}