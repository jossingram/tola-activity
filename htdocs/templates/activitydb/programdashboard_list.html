{% extends "base.html" %}
{% block page_title %}Program Dashboard{% endblock %}

{% block content %}

<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
    Programs
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    {% for program in getPrograms %}
        <li role="presentation"><a role="menuitem" tabindex="-1" href="/activitydb/dashboard/{{ program.id }}">{{ program.gaitid}} - {{ program.name }}</a></li>
    {% endfor %}
  </ul>
  <a href="/activitydb/projectproposal_add" class="btn btn-large btn-success">New Project Proposal</a>&nbsp;<a href="/activitydb/projectproposal_import" class="btn btn-large btn-info">Import Project Proposal</a>
</div>
<br/>
<div>

{% regroup getDashboard by gaitid as programs_by_gaitid %}
<ul class="list-group">
{% for item in programs_by_gaitid %}
    <div class="jumbotron">
        <h3>{{ item.grouper }} - {{ item.list.0.name }}</h3>
        {% if item.list.0.proposal__id %}
            {% regroup item.list by proposal__id as proposal_list %}
            <button class="btn btn-success" type="button" onclick="location.href='/activitydb/projectproposal_list/{{ item.list.0.id }}'">Project Proposal <span class="badge">{{ proposal_list | length }} </span></button>
        {% else %}
             <button class="btn btn-success disabled" type="button">Project Proposal 0 </span></button>
        {% endif %}
        {% if item.list.0.agreement__id %}
            {% regroup item.list by agreement__id as agreement_list %}
            <button class="btn btn-info" type="button" onclick="location.href='/activitydb/projectagreement_list/{{ item.list.0.id }}'">Project Agreement <span class="badge">{{ agreement_list | length }}</span></button>
        {% else %}
             <button class="btn btn-info disabled" type="button">Project Agreement 0 </span></button>
        {% endif %}
        {% if item.list.0.complete__id %}
            {% regroup item.list by complete__id as complete__id %}
            <button class="btn btn-warning" type="button" onclick="location.href='/activitydb/projectcomplete_list/{{ item.list.0.id }}'">Project Completion <span class="badge">{{ complete__id |length }}</span></button>
        {% else %}
             <button class="btn btn-warning disabled" type="button">Project Completion 0 </span></button>
        {% endif %}
    </div>
{% empty %}
    <li class="list-group-item">No proposals yet.</li>
{% endfor %}
</ul>
</div>
{% endblock content %}